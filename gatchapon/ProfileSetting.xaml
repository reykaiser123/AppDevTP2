<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="gatchapon.ProfileSetting"
             BackgroundColor="#ADC179"
             NavigationPage.HasNavigationBar="False"
             Shell.NavBarIsVisible="False">

    <Grid RowDefinitions="Auto, *">

        <!-- 1. CUSTOM HEADER -->
        <Grid Grid.Row="0" 
              BackgroundColor="#ADC179"
              HeightRequest="60"
              Padding="15,0">

            <!-- Back Button -->
            <ImageButton Source="back_icon.png"
                         HeightRequest="30"
                         WidthRequest="30"
                         HorizontalOptions="Start"
                         VerticalOptions="Center"
                         BackgroundColor="Transparent"
                         Clicked="OnBackClicked"/>

            <!-- Title -->
            <Label Text="SETTINGS"
                   TextColor="White"
                   FontSize="20"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"/>
        </Grid>

        <!-- 2. MAIN CONTENT -->
        <ScrollView Grid.Row="1" Padding="20">
            <VerticalStackLayout Spacing="20">

                <!-- A. PROFILE HEADER -->
                <Grid ColumnDefinitions="Auto, *" ColumnSpacing="15">
                    <!-- Avatar Container -->
                    <Grid Grid.Column="0" 
                          HeightRequest="84" 
                          WidthRequest="84"
                          HorizontalOptions="Start"
                          VerticalOptions="Center">

                        <!-- Main Profile Picture -->
                        <Border HeightRequest="80"
                                WidthRequest="80"
                                StrokeShape="RoundRectangle 40"
                                StrokeThickness="0"
                                BackgroundColor="#F1EED8"
                                HorizontalOptions="Center"
                                VerticalOptions="Center">
                            <ImageButton x:Name="ProfileImageButton"
                                         Source="profile_placeholder.png"
                                         Aspect="AspectFill"
                                         Clicked="OnProf"/>
                        </Border>

                        <!-- Edit Icon Overlay -->
                        <Border BackgroundColor="#8C7051"
                                StrokeShape="RoundRectangle 12"
                                StrokeThickness="0"
                                HeightRequest="24"
                                WidthRequest="24"
                                HorizontalOptions="End"
                                VerticalOptions="End"
                                Margin="0,0,0,0">
                            <ImageButton Source="edit_icon.png"
                                          Padding="5"
                                          BackgroundColor="Transparent"
                                          Clicked="OnProf"/>
                        </Border>
                    </Grid>

                    <!-- Name & Edit Info -->
                    <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Spacing="5">
                        <Label x:Name="Userlabel"
                               Text="Loading..."
                               TextColor="#4A3B32"
                               FontSize="18"
                               FontAttributes="Bold"/>

                        <Button Text="Change Username"
                                BackgroundColor="#A58668"
                                TextColor="White"
                                FontSize="12"
                                Padding="10,0"
                                HeightRequest="30"
                                HorizontalOptions="Start"
                                CornerRadius="5"
                                Clicked="Cnamebtn"/>
                    </VerticalStackLayout>
                </Grid>

                <!-- B. ACCOUNT CARD -->
                <Border BackgroundColor="#F1EED8" 
                        StrokeShape="RoundRectangle 15" 
                        StrokeThickness="0" 
                        Padding="20">
                    <VerticalStackLayout Spacing="20">

                        <!-- Email Section -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Email" TextColor="#5D4037" FontAttributes="Bold"/>
                            <Label x:Name="EmailDisplayLabel" Text="..." TextColor="#8D7B6F"/>
                            <Button Text="Change Email"
                                    BackgroundColor="#6E5C4D"
                                    TextColor="White"
                                    FontSize="12"
                                    HorizontalOptions="Start"
                                    Padding="10,0"
                                    HeightRequest="32"
                                    CornerRadius="8"
                                    Clicked="OnUpdateEmailClicked"/>
                        </VerticalStackLayout>

                        <BoxView HeightRequest="1" Color="#DCD6C0"/>

                        <!-- Password Section -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Password" TextColor="#5D4037" FontAttributes="Bold"/>
                            <Label Text="****************" TextColor="#8D7B6F"/>
                            <Button Text="Change Password"
                                    BackgroundColor="#6E5C4D"
                                    TextColor="White"
                                    FontSize="12"
                                    HorizontalOptions="Start"
                                    Padding="10,0"
                                    HeightRequest="32"
                                    CornerRadius="8"
                                    Clicked="OnUpdatePasswordClicked"/>
                        </VerticalStackLayout>

                        <BoxView HeightRequest="1" Color="#DCD6C0"/>

                        <!-- Phone Section -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Phone number (2FA)" TextColor="#5D4037" FontAttributes="Bold"/>
                            <Label x:Name="PhoneLabel" Text="No Phone Set" TextColor="#8D7B6F"/>
                            <Button Text="Change Phone Number"
                                    BackgroundColor="#6E5C4D"
                                    TextColor="White"
                                    FontSize="12"
                                    HorizontalOptions="Start"
                                    Padding="10,0"
                                    HeightRequest="32"
                                    CornerRadius="8"
                                    Clicked="Cphonebtn"/>
                        </VerticalStackLayout>

                        <!-- Logout Button -->
                        <Button Text="Log-out"
                                BackgroundColor="#D66F6F"
                                TextColor="White"
                                FontAttributes="Bold"
                                CornerRadius="8"
                                Margin="0,10,0,0"
                                Clicked="OnLogout"/>
                    </VerticalStackLayout>
                </Border>

                <!-- C. SETTINGS CARD -->
                <Label Text="Settings" TextColor="#5D4037" FontAttributes="Bold" FontSize="16" Margin="0,5,0,0"/>
                <Border BackgroundColor="#F1EED8" StrokeShape="RoundRectangle 15" StrokeThickness="0" Padding="15">
                    <VerticalStackLayout Spacing="0">
                        <!-- Dark Mode -->
                        <Grid ColumnDefinitions="30, *, Auto" HeightRequest="40">
                            <Image Source="moon_icon.png" Aspect="AspectFit" HeightRequest="20"/>
                            <Label Grid.Column="1" Text="Dark Mode" TextColor="#5D4037" VerticalOptions="Center" Margin="10,0,0,0"/>
                            <Switch Grid.Column="2" OnColor="#A58668" IsToggled="False"/>
                        </Grid>

                        <BoxView HeightRequest="1" Color="#DCD6C0" Margin="0,10"/>

                        <!-- Push Notifications -->
                        <Grid ColumnDefinitions="30, *, Auto" HeightRequest="40">
                            <Image Source="bell_icon.png" Aspect="AspectFit" HeightRequest="20"/>
                            <Label Grid.Column="1" Text="Push Notifications" TextColor="#5D4037" VerticalOptions="Center" Margin="10,0,0,0"/>
                            <Switch Grid.Column="2" OnColor="#A58668" IsToggled="True"/>
                        </Grid>
                    </VerticalStackLayout>
                </Border>

                <!-- D. INFORMATION CARD -->
                <Label Text="Information" TextColor="#5D4037" FontAttributes="Bold" FontSize="16" Margin="0,5,0,0"/>
                <Border BackgroundColor="#F1EED8" StrokeShape="RoundRectangle 15" StrokeThickness="0" Padding="15">
                    <VerticalStackLayout Spacing="0">

                        <!-- App Version -->
                        <Grid ColumnDefinitions="30, *, Auto" HeightRequest="40">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnAppV"/>
                            </Grid.GestureRecognizers>
                            <Image Source="info_icon.png" Aspect="AspectFit" HeightRequest="20"/>
                            <Label Grid.Column="1" Text="App Version" TextColor="#5D4037" VerticalOptions="Center" Margin="10,0,0,0"/>
                            <Label Grid.Column="2" Text="v0.1" TextColor="#A58668" FontAttributes="Bold" VerticalOptions="Center"/>
                        </Grid>

                        <BoxView HeightRequest="1" Color="#DCD6C0" Margin="0,10"/>

                        <!-- Support -->
                        <Grid ColumnDefinitions="30, *, Auto" HeightRequest="40">
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnSup"/>
                            </Grid.GestureRecognizers>
                            <Image Source="question_icon.png" Aspect="AspectFit" HeightRequest="20"/>
                            <Label Grid.Column="1" Text="Support" TextColor="#5D4037" VerticalOptions="Center" Margin="10,0,0,0"/>
                            <Label Grid.Column="2" Text=">" TextColor="#A58668" FontAttributes="Bold" VerticalOptions="Center"/>
                        </Grid>

                    </VerticalStackLayout>
                </Border>

                <BoxView HeightRequest="50" Color="Transparent"/>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>